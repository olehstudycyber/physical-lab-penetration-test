# ğŸ”“ LDAP Enumeration & Brute-Force Attempt â€“ 192.168.1.2

This document records the LDAP reconnaissance and password attack attempts against the Windows Server 2025 machine running on the domain `narnia.com`.

---

## ğŸ§ª LDAP Enumeration with `ldapsearch`

### ğŸ”¸ Attempts Made:
Several `ldapsearch` commands were run to enumerate domain information, including:
- Common mistake: used `-h` and `-p` options (deprecated)
- Correct method: use the `-H` option to define LDAP URI like:
  ```bash
  ldapsearch -x -H ldap://192.168.1.2 -b namingContexts
ğŸ”¹ Outcome:
LDAP service was reachable on port 389

Enumeration failed due to incorrect option usage

No domain naming contexts or user entries retrieved yet

ğŸ” Hydra LDAP Brute-Force Attempts
ğŸ”¸ Tool:
Hydra v9.5

ğŸ”¸ Commands Tried:
bash
Copy
Edit
hydra -L user_list.txt -P rockyou.txt ldap2://192.168.1.2
Then later:

bash
Copy
Edit
hydra -L user_list.txt -P rockyou.txt ldap3://192.168.1.2
ğŸ”¹ Errors Encountered:
user_list.txt was missing

Attempted LDAP3 simple authentication without providing -m (Bind DN)

Hydra requires -m "CN=User,...,DC=narnia,DC=com" to specify which DN to try logging into

âœ… LDAP3 works with Hydra, but proper -m usage and correct user list are required for success.

ğŸ› ï¸ CrackMapExec & Impacket
crackmapexec (SMB):
bash
Copy
Edit
crackmapexec smb 192.168.1.2 -u user_list.txt -p password123
Result: SMB reachable, domain identified as narnia.com, OS: Windows 10.0 build 26100

âŒ Connection failed: NetBIOS timeout â€” likely because username list was invalid or server filtering was applied

impacket-GetNPUsers:
bash
Copy
Edit
impacket-GetNPUsers narnia.com/ -no-pass -usersfile user_list.txt
âŒ Failed due to missing user_list.txt file

âœ… Lessons & Next Steps
âœ… Use ldapsearch -x -H ldap://192.168.1.2 -b namingContexts to correctly enumerate base DNs

âœ… Create a proper user_list.txt file with likely usernames

âœ… For Hydra:

Use the -m option to define the DN path

Try:

bash
Copy
Edit
hydra -L user_list.txt -P rockyou.txt ldap3://192.168.1.2 -m "cn=%u,dc=narnia,dc=com"
âœ… Use GetNPUsers with a valid user list to look for ASREP roastable accounts

âš ï¸ All actions are for lab-based educational use only.
